<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Backup & Restore - PrivateRAT v2.0</title>
  <link rel="stylesheet" href="/css/semantic.min.css">
  <link rel="stylesheet" href="/css/custom.css">
  <link rel="stylesheet" href="/css/design-system.css">
  <link rel="stylesheet" href="/css/sidebar.css">
  <link rel="icon" href="/favicon.ico" type="image/x-icon">
  <style>
    .backup-container {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
      gap: 24px;
    }

    @media (max-width: 768px) {
      .backup-container {
        grid-template-columns: 1fr;
      }
    }

    .backup-card {
      background: white;
      border-radius: 16px;
      padding: 30px;
      box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
    }

    .backup-card h3 {
      font-size: 20px;
      font-weight: 700;
      color: #2d3748;
      margin-bottom: 20px;
      display: flex;
      align-items: center;
      gap: 12px;
    }

    .backup-card h3 i {
      color: #667eea;
      font-size: 24px;
    }

    .backup-info {
      background: #f7fafc;
      padding: 16px;
      border-radius: 10px;
      margin-bottom: 20px;
      font-size: 14px;
      color: #718096;
    }

    .backup-info strong {
      color: #2d3748;
      display: block;
      margin-bottom: 8px;
    }

    .file-input-wrapper {
      position: relative;
      margin-bottom: 16px;
    }

    .file-input-wrapper input[type="file"] {
      width: 100%;
      padding: 12px;
      border: 2px dashed #e2e8f0;
      border-radius: 10px;
      background: #f7fafc;
      cursor: pointer;
      transition: all 0.3s;
    }

    .file-input-wrapper input[type="file"]:hover {
      border-color: #667eea;
      background: #edf2f7;
    }
  </style>
  <script src="/js/jquery-3.4.1.min.js"></script>
  <script src="/js/semantic.min.js"></script>
</head>
<body>
  <button class="mobile-toggle" onclick="toggleSidebar()">
    <i class="bars icon"></i>
  </button>

  <div class="app-container">
    <%- include('partials/sidebar.ejs', { activePage: 'backup' }) %>

    <div class="main-content">
      <div class="page-header">
        <h1 class="page-title">Backup & Restore</h1>
        <p class="page-subtitle">Backup your data and restore from previous backups</p>
      </div>

      <div class="backup-container">
        <!-- Backup Section -->
        <div class="backup-card">
          <h3><i class="download icon"></i> Create Backup</h3>
          <div class="backup-info">
            <strong>Backup Information</strong>
            <div>Backup includes all system data, device information, and logs.</div>
            <div style="margin-top: 8px;">Last backup: <span id="lastBackup">Never</span></div>
          </div>
          <button class="btn btn-primary" onclick="createBackup()" style="width: 100%;">
            <i class="download icon"></i> Download Backup
          </button>
        </div>

        <!-- Restore Section -->
        <div class="backup-card">
          <h3><i class="upload icon"></i> Restore Backup</h3>
          <div class="backup-info">
            <strong>Restore Information</strong>
            <div>Restore will replace all current data with backup data. This action cannot be undone.</div>
          </div>
          <div class="file-input-wrapper">
            <input type="file" id="backupFile" accept=".json" onchange="handleFileSelect(this)">
          </div>
          <button class="btn btn-warning" onclick="restoreBackup()" id="restoreBtn" disabled style="width: 100%;">
            <i class="upload icon"></i> Upload & Restore
          </button>
        </div>
      </div>

      <!-- Backup History -->
      <div class="card" style="margin-top: 24px;">
        <div class="card-header">
          <h3 class="card-title"><i class="history icon"></i> Backup History</h3>
        </div>
        <div class="card-body">
          <div class="empty-state">
            <div class="empty-icon"><i class="database icon"></i></div>
            <div class="empty-title">No backup history</div>
            <div class="empty-desc">Create your first backup to see history here</div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <script>
    function toggleSidebar() {
      const sidebar = document.getElementById('sidebar');
      sidebar.classList.toggle('open');
    }

    document.addEventListener('click', function(event) {
      const sidebar = document.getElementById('sidebar');
      const mobileToggle = document.querySelector('.mobile-toggle');
      if (window.innerWidth <= 768 && 
          !sidebar.contains(event.target) && 
          !mobileToggle.contains(event.target)) {
        sidebar.classList.remove('open');
      }
    });

    function createBackup() {
      // Simulate backup creation
      alert('Backup created successfully! Download will start shortly.');
      document.getElementById('lastBackup').textContent = new Date().toLocaleString();
    }

    function handleFileSelect(input) {
      if (input.files && input.files[0]) {
        document.getElementById('restoreBtn').disabled = false;
      } else {
        document.getElementById('restoreBtn').disabled = true;
      }
    }

    function restoreBackup() {
      const file = document.getElementById('backupFile').files[0];
      if (!file) {
        alert('Please select a backup file first!');
        return;
      }

      if (confirm('Are you sure you want to restore from this backup? All current data will be replaced!')) {
        // Simulate restore
        alert('Backup restored successfully!');
        document.getElementById('backupFile').value = '';
        document.getElementById('restoreBtn').disabled = true;
      }
    }
  </script>
</body>
</html>
